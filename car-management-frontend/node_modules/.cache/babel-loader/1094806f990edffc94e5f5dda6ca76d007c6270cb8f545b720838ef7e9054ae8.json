{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useParams,useNavigate}from'react-router-dom';import API from'../api';import Navbar from'../components/Navbar';import'../styles/CarEditPage.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CarEditPage=()=>{const{id}=useParams();const navigate=useNavigate();const[form,setForm]=useState({title:'',description:'',tags:{car_type:'',company:'',dealer:''}});const[imageFiles,setImageFiles]=useState([]);const[existingImages,setExistingImages]=useState([]);const fetchCarDetails=async()=>{try{const response=await API.get(`/cars/${id}`);const{title,description,tags,images}=response.data;setForm({title,description,tags});setExistingImages(images);}catch(err){var _err$response,_err$response$data;alert('Error fetching car details: '+((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Server error');}};const handleInputChange=e=>{const{name,value}=e.target;setForm({...form,[name]:value});};const handleTagChange=e=>{const{name,value}=e.target;setForm({...form,tags:{...form.tags,[name]:value}});};const handleImageChange=e=>{const files=Array.from(e.target.files);if(files.length+existingImages.length>10){alert('You can only have up to 10 images.');return;}setImageFiles(files);};const handleRemoveImage=image=>{setExistingImages(existingImages.filter(img=>img!==image));};const handleSubmit=async e=>{e.preventDefault();const formData=new FormData();formData.append('title',form.title);formData.append('description',form.description);Object.entries(form.tags).forEach(_ref=>{let[key,value]=_ref;formData.append(`tags[${key}]`,value);});imageFiles.forEach(file=>{formData.append('images',file);});formData.append('removeImages',JSON.stringify(existingImages));try{await API.put(`/cars/${id}`,formData,{headers:{'Content-Type':'multipart/form-data'}});alert('Car updated successfully!');navigate(`/cars/${id}`);}catch(err){var _err$response2,_err$response2$data;alert(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.message)||'Error updating car.');}};useEffect(()=>{fetchCarDetails();},[id]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"edit-container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Edit Car\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,encType:\"multipart/form-data\",className:\"edit-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Title\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"title\",value:form.title,onChange:handleInputChange,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Description\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"description\",value:form.description,onChange:handleInputChange,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Car Type\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"car_type\",value:form.tags.car_type,onChange:handleTagChange})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Company\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"company\",value:form.tags.company,onChange:handleTagChange})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Dealer\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"dealer\",value:form.tags.dealer,onChange:handleTagChange})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"image-preview\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Existing Images\"}),/*#__PURE__*/_jsx(\"div\",{className:\"image-list\",children:existingImages.map((image,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"image-item\",children:[/*#__PURE__*/_jsx(\"img\",{src:image,alt:`Existing ${index+1}`}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"remove-button\",onClick:()=>handleRemoveImage(image),children:\"Remove\"})]},index))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Add New Images\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"images\",accept:\"image/*\",multiple:true,onChange:handleImageChange})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"submit-button\",children:\"Update Car\"})]})]})]});};export default CarEditPage;","map":{"version":3,"names":["React","useEffect","useState","useParams","useNavigate","API","Navbar","jsx","_jsx","jsxs","_jsxs","CarEditPage","id","navigate","form","setForm","title","description","tags","car_type","company","dealer","imageFiles","setImageFiles","existingImages","setExistingImages","fetchCarDetails","response","get","images","data","err","_err$response","_err$response$data","alert","message","handleInputChange","e","name","value","target","handleTagChange","handleImageChange","files","Array","from","length","handleRemoveImage","image","filter","img","handleSubmit","preventDefault","formData","FormData","append","Object","entries","forEach","_ref","key","file","JSON","stringify","put","headers","_err$response2","_err$response2$data","children","className","onSubmit","encType","type","onChange","required","map","index","src","alt","onClick","accept","multiple"],"sources":["C:/Users/anura/assignment-/car-management-frontend/src/pages/CarEditPage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport API from '../api';\r\nimport Navbar from '../components/Navbar';\r\nimport '../styles/CarEditPage.css';\r\n\r\nconst CarEditPage = () => {\r\n  const { id } = useParams();\r\n  const navigate = useNavigate();\r\n  const [form, setForm] = useState({\r\n    title: '',\r\n    description: '',\r\n    tags: { car_type: '', company: '', dealer: '' },\r\n  });\r\n  const [imageFiles, setImageFiles] = useState([]);\r\n  const [existingImages, setExistingImages] = useState([]);\r\n\r\n  const fetchCarDetails = async () => {\r\n    try {\r\n      const response = await API.get(`/cars/${id}`);\r\n      const { title, description, tags, images } = response.data;\r\n      setForm({ title, description, tags });\r\n      setExistingImages(images);\r\n    } catch (err) {\r\n      alert('Error fetching car details: ' + err.response?.data?.message || 'Server error');\r\n    }\r\n  };\r\n\r\n  const handleInputChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setForm({ ...form, [name]: value });\r\n  };\r\n\r\n  const handleTagChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setForm({ ...form, tags: { ...form.tags, [name]: value } });\r\n  };\r\n\r\n  const handleImageChange = (e) => {\r\n    const files = Array.from(e.target.files);\r\n    if (files.length + existingImages.length > 10) {\r\n      alert('You can only have up to 10 images.');\r\n      return;\r\n    }\r\n    setImageFiles(files);\r\n  };\r\n\r\n  const handleRemoveImage = (image) => {\r\n    setExistingImages(existingImages.filter((img) => img !== image));\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    const formData = new FormData();\r\n    formData.append('title', form.title);\r\n    formData.append('description', form.description);\r\n    Object.entries(form.tags).forEach(([key, value]) => {\r\n      formData.append(`tags[${key}]`, value);\r\n    });\r\n    imageFiles.forEach((file) => {\r\n      formData.append('images', file);\r\n    });\r\n    formData.append('removeImages', JSON.stringify(existingImages));\r\n\r\n    try {\r\n      await API.put(`/cars/${id}`, formData, {\r\n        headers: { 'Content-Type': 'multipart/form-data' },\r\n      });\r\n      alert('Car updated successfully!');\r\n      navigate(`/cars/${id}`);\r\n    } catch (err) {\r\n      alert(err.response?.data?.message || 'Error updating car.');\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchCarDetails();\r\n  }, [id]);\r\n\r\n  return (\r\n    <div>\r\n      <Navbar />\r\n      <div className=\"edit-container\">\r\n        <h1>Edit Car</h1>\r\n        <form onSubmit={handleSubmit} encType=\"multipart/form-data\" className=\"edit-form\">\r\n          <div className=\"form-group\">\r\n            <label>Title</label>\r\n            <input\r\n              type=\"text\"\r\n              name=\"title\"\r\n              value={form.title}\r\n              onChange={handleInputChange}\r\n              required\r\n            />\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <label>Description</label>\r\n            <textarea\r\n              name=\"description\"\r\n              value={form.description}\r\n              onChange={handleInputChange}\r\n              required\r\n            ></textarea>\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <label>Car Type</label>\r\n            <input\r\n              type=\"text\"\r\n              name=\"car_type\"\r\n              value={form.tags.car_type}\r\n              onChange={handleTagChange}\r\n            />\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <label>Company</label>\r\n            <input\r\n              type=\"text\"\r\n              name=\"company\"\r\n              value={form.tags.company}\r\n              onChange={handleTagChange}\r\n            />\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <label>Dealer</label>\r\n            <input\r\n              type=\"text\"\r\n              name=\"dealer\"\r\n              value={form.tags.dealer}\r\n              onChange={handleTagChange}\r\n            />\r\n          </div>\r\n          <div className=\"image-preview\">\r\n            <strong>Existing Images</strong>\r\n            <div className=\"image-list\">\r\n              {existingImages.map((image, index) => (\r\n                <div key={index} className=\"image-item\">\r\n                  <img src={image} alt={`Existing ${index + 1}`} />\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"remove-button\"\r\n                    onClick={() => handleRemoveImage(image)}\r\n                  >\r\n                    Remove\r\n                  </button>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <label>Add New Images</label>\r\n            <input\r\n              type=\"file\"\r\n              name=\"images\"\r\n              accept=\"image/*\"\r\n              multiple\r\n              onChange={handleImageChange}\r\n            />\r\n          </div>\r\n          <button type=\"submit\" className=\"submit-button\">\r\n            Update Car\r\n          </button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CarEditPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}